(function(){var g=YAHOO.util.Dom,a=YAHOO.util.Event;Alfresco.component.StartWorkflow=function e(i){Alfresco.component.StartWorkflow.superclass.constructor.call(this,i,["button"]);this.name="Alfresco.component.StartWorkflow";Alfresco.util.ComponentManager.reregister(this);this.options=YAHOO.lang.merge(this.options,Alfresco.component.StartWorkflow.superclass.options);this.selectedItems="";this.destination="";this.workflowTypes=[];YAHOO.Bubbling.on("objectFinderReady",this.onObjectFinderReady,this);YAHOO.Bubbling.on("formContentReady",this.onStartWorkflowFormContentReady,this);return this};YAHOO.extend(Alfresco.component.StartWorkflow,Alfresco.component.ShareFormManager,{options:{selectedItems:"",destination:"",workflowDefinitions:[]},onReady:function f(){this.widgets.workflowDefinitionMenuButton=Alfresco.util.createYUIButton(this,"workflow-definition-button",this.onWorkflowSelectChange,{label:this.msg("label.selectWorkflowDefinition"),title:this.msg("title.selectWorkflowDefinition"),type:"menu",menu:"workflow-definition-menu"});return Alfresco.component.StartWorkflow.superclass.onReady.call(this)},onObjectFinderReady:function c(j,i){var k=i[1].eventGroup;if(k.options.field=="assoc_packageItems"&&k.eventGroup.indexOf(this.id)==0){k.selectItems(this.options.selectedItems)}},onWorkflowSelectChange:function d(l,k){var m=k[1].index;if(m>=0){var j=this.options.workflowDefinitions[m];this.widgets.workflowDefinitionMenuButton.set("label",j.title);this.widgets.workflowDefinitionMenuButton.set("title",j.description);Alfresco.util.Ajax.request({url:Alfresco.constants.URL_SERVICECONTEXT+"components/form",dataObj:{htmlid:this.id+"-startWorkflowForm-"+Alfresco.util.generateDomId(),itemKind:"workflow",itemId:j.name,mode:"create",submitType:"json",showCaption:true,formUI:true,showCancelButton:true,destination:this.options.destination},successCallback:{fn:this.onWorkflowFormLoaded,scope:this},failureMessage:this.msg("message.failure"),scope:this,execScripts:true})}},onWorkflowFormLoaded:function b(i){var j=g.get(this.id+"-workflowFormContainer");g.addClass(j,"hidden");j.innerHTML=i.serverResponse.responseText},onStartWorkflowFormContentReady:function h(k,i){var j=g.get(this.id+"-workflowFormContainer");g.removeClass(j,"hidden")}})})();