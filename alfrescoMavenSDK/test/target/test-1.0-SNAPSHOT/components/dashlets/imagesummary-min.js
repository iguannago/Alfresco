(function(){var b=YAHOO.util.Event,d=YAHOO.util.Dom;var a=Alfresco.util.encodeHTML;Alfresco.dashlet.ImageSummary=function e(g){Alfresco.dashlet.ImageSummary.superclass.constructor.call(this,"Alfresco.dashlet.ImageSummary",g);this.itemsPerRow=0;b.addListener(window,"resize",this.resizeThumbnailList,this,true);return this};YAHOO.extend(Alfresco.dashlet.ImageSummary,Alfresco.component.Base,{itemsPerRow:0,onReady:function f(){Alfresco.util.Ajax.jsonRequest({url:Alfresco.constants.PROXY_URI+"slingshot/doclib/images/site/"+this.options.siteId+"/documentLibrary?max=250",successCallback:{fn:function(k){var g=d.get(this.id+"-images"),q=d.get(this.id+"-item-template"),n=k.json.items;var p=unescape(q.innerHTML);for(var m=0,l=n.length,o,r;m<l;m++){r=n[m];var h={nodeRef:r.nodeRef,nodeRefUrl:r.nodeRef.replace(":/",""),name:encodeURIComponent(r.name),title:a(r.title),modifier:this.msg("text.modified-by",a(r.modifier)),modified:Alfresco.util.formatDate(Alfresco.util.fromISO8601(r.modifiedOn))};o=q.cloneNode(true);o.innerHTML=YAHOO.lang.substitute(p,h);g.appendChild(o)}d.addClass(this.id+"-wait","hidden");d.removeClass(g,"hidden")},scope:this},failureCallback:{fn:function(g){d.addClass(this.id+"-wait","hidden");var h=d.get(this.id+"-message");h.innerHTML=a(g.json.message);d.removeClass(h,"hidden")},scope:this}})},resizeThumbnailList:function c(n){var g=d.get(this.id+"-list");var m=Math.floor((g.clientWidth-16)/112);if(m==0){m=1}if(m!==this.itemsPerRow){this.itemsPerRow=m;var h=d.getElementsByClassName("item",null,g);for(var l=0,k=h.length;l<k;l++){if(l%m==0){d.addClass(h[l],"initial")}else{d.removeClass(h[l],"initial")}}}}})})();