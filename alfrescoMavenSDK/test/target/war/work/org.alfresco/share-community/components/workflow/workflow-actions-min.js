(function(){var e=YAHOO.util.Dom,i=YAHOO.util.Event;var b=Alfresco.util.encodeHTML,c=Alfresco.util.combinePaths,d=Alfresco.util.siteURL;Alfresco.action.WorkflowActions={};Alfresco.action.WorkflowActions.prototype={cancelWorkflow:function a(n,k){var l=this,m=n;Alfresco.util.PopupManager.displayPrompt({title:this.msg("workflow.cancel.title"),text:this.msg("workflow.cancel.label",k),noEscape:true,buttons:[{text:Alfresco.util.message("button.yes",this.name),handler:function o(){this.destroy();l._cancelWorkflow.call(l,m)}},{text:Alfresco.util.message("button.no",this.name),handler:function j(){this.destroy()},isDefault:true}]})},_cancelWorkflow:function f(l){var j=this;var k=Alfresco.util.PopupManager.displayMessage({text:this.msg("workflow.cancel.feedback"),spanClass:"wait",displayTime:0});Alfresco.util.Ajax.jsonDelete({url:Alfresco.constants.PROXY_URI+"api/workflow-instances/"+l,successCallback:{fn:function(m,n){k.destroy();if(m.json&&m.json.success){Alfresco.util.PopupManager.displayMessage({text:this.msg("workflow.cancel.success",this.name)});YAHOO.Bubbling.fire("workflowCancelled",{workflow:{id:n}})}else{Alfresco.util.PopupManager.displayMessage({text:Alfresco.util.message("workflow.cancel.failure",this.name)})}},obj:l,scope:this},failureCallback:{fn:function(m){k.destroy();Alfresco.util.PopupManager.displayMessage({text:Alfresco.util.message("workflow.cancel.failure",this.name)})},scope:this}})},createFilterURLParameters:function h(k,o){if(YAHOO.lang.isString(k.filterData)){var n,j=null;for(var m=0,l=o.length;m<l;m++){n=o[m];if((k.filterId==n.id||n.id=="*")&&(k.filterData==n.data||n.data=="*")){return this.substituteParameters(n.parameters,{id:k.filterId,data:k.filterData})}}}return null},substituteParameters:function(r,m){var o=r.match(/{[^}]+}/g);if(o){var j={},k,q,l;for(var n=0,p=o.length;n<p;n++){k=o[n].substring(1,o[n].length-1);q=k;l=new Date();if(/^[\-\+]?\d+(d|dt)$/.test(q)){if(/^[\-\+]?\d+(d)$/.test(q)){l.setHours(11);l.setMinutes(59);l.setSeconds(59);l.setMilliseconds(999)}l.setDate(l.getDate()+parseInt(q));q=l}else{q=m[k]}j[k]=Alfresco.util.isDate(q)?Alfresco.util.toISO8601(q):q}return YAHOO.lang.substitute(r,j)}return r},createAction:function g(p,k,l,o,n){var q=document.createElement("div");e.addClass(q,l);q.onmouseover=function(){e.addClass(this,l+"-over")};q.onmouseout=function(){e.removeClass(this,l+"-over")};var j=document.createElement("a");if(YAHOO.lang.isFunction(o)){i.addListener(j,"click",o,n,this);j.setAttribute("href","#")}else{j.setAttribute("href",o)}var m=document.createElement("span");e.addClass(m,"theme-color-1");m.appendChild(document.createTextNode(k));j.appendChild(m);q.appendChild(j);p.appendChild(q)}}})();